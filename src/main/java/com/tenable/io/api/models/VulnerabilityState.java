package com.tenable.io.api.models;


import com.fasterxml.jackson.annotation.JsonCreator;
import com.fasterxml.jackson.annotation.JsonValue;
import com.tenable.io.core.exceptions.TenableIoErrorCode;
import com.tenable.io.core.exceptions.TenableIoException;


/**
 * Copyright (c) 2017 Tenable Network Security, Inc.
 */
public enum VulnerabilityState {
    /**
     * The vulnerability is active.
     */
    ACTIVE( "Active" ),
    /**
     * The vulnerability was first found within the preceding 14 days..
     */
    NEW( "New" ),
    /**
     * The vulnerability is fixed.
     */
    FIXED( "Fixed" ),
    /**
     * The vulnerability has resurfaced.
     */
    RESURFACED( "Resurfaced" ),
    /**
     * The bulnerability is open
     */
    OPEN( "Open" ),
    /**
     * The vulnerability has been reopened
     */
    REOPENED( "Reopened" );

    private final String value;
    private final String lowerCasedValue;


    private VulnerabilityState( String value ) {
        this.value = value;
        this.lowerCasedValue = value.toLowerCase();
    }


    /**
     * Gets the VulnerabilityState string value.
     *
     * @return the VulnerabilityState string value
     */
    @JsonValue
    public String getValue() {
        return value;
    }


    /**
     * Gets the VulnerabilityState string value.
     *
     * @return the VulnerabilityState string value
     */
    public String toString() {
        return getValue();
    }


    /**
     * Converts string value to enum value
     *
     * @param value the string value
     * @return the VulnerabilityState corresponding to the given string value
     * @throws TenableIoException the tenable IO exception
     */
    @JsonCreator
    public static VulnerabilityState forValue( String value ) throws TenableIoException {

        for( VulnerabilityState enumValue : VulnerabilityState.values() ) {
            if( enumValue.lowerCasedValue.equals( value.toLowerCase() ) ) {
                return enumValue;
            }
        }
        throw new TenableIoException( TenableIoErrorCode.DeserializationError, "Invalid VulnerabilityState value: " + value + "." );
    }
}
